<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/home.css">
    <title>{{ personal_info.author_name }} - switcher.io</title>
</head>
<body>
    <section class="sidebar"> 
        <span style="display: block; height:6rem; color:white" href="">switcher.io</span>
        <ul>
            <a href="{{ url_for('home') }}" class="menu-link">
                <svg width="40" height="35" viewBox="0 0 60 54" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_71_5)">
                    <path d="M59.9792 26.6464C59.9792 28.5237 58.4167 29.9942 56.6458 29.9942H53.3125L53.3854 46.7016C53.3854 46.9832 53.3646 47.2648 53.3333 47.5464V49.2255C53.3333 51.5303 51.4688 53.3971 49.1667 53.3971H47.5C47.3854 53.3971 47.2708 53.3971 47.1563 53.3867C47.0104 53.3971 46.8646 53.3971 46.7188 53.3971H43.3333H40.8333C38.5313 53.3971 36.6667 51.5303 36.6667 49.2255V46.7225V40.0478C36.6667 38.2019 35.1771 36.7105 33.3333 36.7105H26.6667C24.8229 36.7105 23.3333 38.2019 23.3333 40.0478V46.7225V49.2255C23.3333 51.5303 21.4688 53.3971 19.1667 53.3971H16.6667H13.3438C13.1875 53.3971 13.0313 53.3867 12.875 53.3763C12.75 53.3867 12.625 53.3971 12.5 53.3971H10.8333C8.53125 53.3971 6.66667 51.5303 6.66667 49.2255V37.5449C6.66667 37.451 6.66667 37.3467 6.67708 37.2528V29.9942H3.33333C1.45833 29.9942 0 28.5341 0 26.6464C0 25.7078 0.3125 24.8735 1.04167 24.1434L27.75 0.83433C28.4792 0.104291 29.3125 0 30.0417 0C30.7708 0 31.6042 0.208583 32.2292 0.730039L58.8333 24.1434C59.6667 24.8735 60.0833 25.7078 59.9792 26.6464Z" fill="white"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_71_5">
                    <rect width="60" height="53.3971" fill="white"/>
                    </clipPath>
                    </defs>
                </svg>  
            </a>
            <a href="{{ url_for('search') }}" class="menu-link">
                <svg width="40" height="40" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_71_3)">
                    <path d="M48.75 24.375C48.75 29.7539 47.0039 34.7227 44.0625 38.7539L58.8984 53.6016C60.3633 55.0664 60.3633 57.4453 58.8984 58.9102C57.4336 60.375 55.0547 60.375 53.5898 58.9102L38.7539 44.0625C34.7227 47.0156 29.7539 48.75 24.375 48.75C10.9102 48.75 0 37.8398 0 24.375C0 10.9102 10.9102 0 24.375 0C37.8398 0 48.75 10.9102 48.75 24.375ZM24.375 41.25C33.6914 41.25 41.25 33.6914 41.25 24.375C41.25 15.0586 33.6914 7.5 24.375 7.5C15.0586 7.5 7.5 15.0586 7.5 24.375C7.5 33.6914 15.0586 41.25 24.375 41.25Z" fill="white"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_71_3">
                    <rect width="60" height="60" fill="white"/>
                    </clipPath>
                    </defs>
                </svg>    
            </a>
            <a href="{{ url_for('help') }}" class="menu-link">
                <svg width="40" height="40" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_71_7)">
                    <path d="M30 60C46.5703 60 60 46.5703 60 30C60 13.4297 46.5703 0 30 0C13.4297 0 0 13.4297 0 30C0 46.5703 13.4297 60 30 60ZM25.3125 39.375H28.125V31.875H25.3125C23.7539 31.875 22.5 30.6211 22.5 29.0625C22.5 27.5039 23.7539 26.25 25.3125 26.25H30.9375C32.4961 26.25 33.75 27.5039 33.75 29.0625V39.375H34.6875C36.2461 39.375 37.5 40.6289 37.5 42.1875C37.5 43.7461 36.2461 45 34.6875 45H25.3125C23.7539 45 22.5 43.7461 22.5 42.1875C22.5 40.6289 23.7539 39.375 25.3125 39.375ZM30 22.5C27.9258 22.5 26.25 20.8242 26.25 18.75C26.25 16.6758 27.9258 15 30 15C32.0742 15 33.75 16.6758 33.75 18.75C33.75 20.8242 32.0742 22.5 30 22.5Z" fill="white"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_71_7">
                    <rect width="60" height="60" fill="white"/>
                    </clipPath>
                    </defs>
                </svg>
            </a>
        </ul>
    </section>
    <main>
        <h1>{{personal_info.author_name}}</h1>
        <div class="box">
            <div class="shadow-box" style="padding: 2rem;">
                <div class="personal-info">
                    <div class="personal-stats">
                        <span>Current institution:</span>
                        <span>{{ personal_info.last_inst }}</span>
                        <span>Total citations:</span>
                        <span>{{ personal_info.total_cits }}</span>
                        <span>Estimated location:</span>
                        <span>{{ personal_info.author_location }}</span>
                        <span>Associated institutions:</span>
                        <span>{{ personal_info.list_institutions }}</span>
                    </div>
                    <img class="profile-pic" src="../static/img/proifle.webp" alt="">
                </div>
            </div>
        </div>

        <div class="box">
            <h3>Citations per year</h3>
            <div class="shadow-box" style="padding: 2rem;">
                <div class="citations">
                    <canvas id="myChart"></canvas>
                </div>
            </div>
        </div>

        <div class="box">
            <h3>Network of {{personal_info.author_name}}</h3>
            <div class="shadow-box">
                <div class="network-container">
                    <div id="mynetwork" class="card-body"></div>
                </div>
            </div>
        </div>

        <div class="box">
            <h3>Papers by {{ personal_info.author_name }}</h3>
            {% for paper in all_papers[:5] %}
                <div class="shadow-box paper-entry">
                    <span class="paper-name">{{ paper.title }}</span>
                    <span class="paper-year">{{ paper.year }}</span>
                    <a class="paper-link" target="_blank" href="{{ paper.link }}">
                        <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_3_28)">
                            <path d="M14.375 0C13.5799 0 12.9375 0.642383 12.9375 1.4375C12.9375 2.23262 13.5799 2.875 14.375 2.875H18.09L9.04727 11.9223C8.48574 12.4838 8.48574 13.3957 9.04727 13.9572C9.60879 14.5188 10.5207 14.5188 11.0822 13.9572L20.125 4.90996V8.625C20.125 9.42012 20.7674 10.0625 21.5625 10.0625C22.3576 10.0625 23 9.42012 23 8.625V1.4375C23 0.642383 22.3576 0 21.5625 0H14.375ZM3.59375 1.4375C1.6082 1.4375 0 3.0457 0 5.03125V19.4062C0 21.3918 1.6082 23 3.59375 23H17.9688C19.9543 23 21.5625 21.3918 21.5625 19.4062V14.375C21.5625 13.5799 20.9201 12.9375 20.125 12.9375C19.3299 12.9375 18.6875 13.5799 18.6875 14.375V19.4062C18.6875 19.8016 18.3641 20.125 17.9688 20.125H3.59375C3.19844 20.125 2.875 19.8016 2.875 19.4062V5.03125C2.875 4.63594 3.19844 4.3125 3.59375 4.3125H8.625C9.42012 4.3125 10.0625 3.67012 10.0625 2.875C10.0625 2.07988 9.42012 1.4375 8.625 1.4375H3.59375Z" fill="black"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_3_28">
                            <rect width="23" height="23" fill="white"/>
                            </clipPath>
                            </defs>
                        </svg>    
                    </a>
                </div>
            {% endfor %}
            {% if num_papers > 5 %}
                <div class="more-papers">
                    {% for paper in all_papers[5:] %}
                        <div class="shadow-box paper-entry">
                            <span class="paper-name">{{ paper.title }}</span>
                            <span class="paper-year">{{ paper.year }}</span>
                            <a class="paper-link" target="_blank" href="{{ paper.link }}">
                                <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <g clip-path="url(#clip0_3_28)">
                                    <path d="M14.375 0C13.5799 0 12.9375 0.642383 12.9375 1.4375C12.9375 2.23262 13.5799 2.875 14.375 2.875H18.09L9.04727 11.9223C8.48574 12.4838 8.48574 13.3957 9.04727 13.9572C9.60879 14.5188 10.5207 14.5188 11.0822 13.9572L20.125 4.90996V8.625C20.125 9.42012 20.7674 10.0625 21.5625 10.0625C22.3576 10.0625 23 9.42012 23 8.625V1.4375C23 0.642383 22.3576 0 21.5625 0H14.375ZM3.59375 1.4375C1.6082 1.4375 0 3.0457 0 5.03125V19.4062C0 21.3918 1.6082 23 3.59375 23H17.9688C19.9543 23 21.5625 21.3918 21.5625 19.4062V14.375C21.5625 13.5799 20.9201 12.9375 20.125 12.9375C19.3299 12.9375 18.6875 13.5799 18.6875 14.375V19.4062C18.6875 19.8016 18.3641 20.125 17.9688 20.125H3.59375C3.19844 20.125 2.875 19.8016 2.875 19.4062V5.03125C2.875 4.63594 3.19844 4.3125 3.59375 4.3125H8.625C9.42012 4.3125 10.0625 3.67012 10.0625 2.875C10.0625 2.07988 9.42012 1.4375 8.625 1.4375H3.59375Z" fill="black"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_3_28">
                                    <rect width="23" height="23" fill="white"/>
                                    </clipPath>
                                    </defs>
                                </svg>    
                            </a>
                        </div>
                    {% endfor %}
                </div>
                <span id="expand-info">... and another {{ num_papers - 5 }} papers</span>
                <span class="primary-btn span-btn" id="expand-papers">Show all papers</span>
            {% endif %}
        </div>

        <div class="box">
            <h3>Get in touch</h3>
            <div class="shadow-box contact-form">
                <textarea class="email-text" name="" id="" cols="90" rows="12">
Dear Mr. Jurowetzki,

I have read your paper on “Transformer models for autonomous driving”.
Very great work!

We want you in our company!

Best regards,
John Doe
                </textarea>
                <button class="primary-btn">Send email</button>
            </div>
        </div>

    </main>

    <script>
        {% if num_papers > 5 %}
            var xpanded = false

            const xpanderBtn = document.getElementById("expand-papers")
            const xpanderBox = document.querySelector(".more-papers")
            const xpanderInfo = document.getElementById("expand-info")
            const info_text = xpanderInfo.innerText
            xpanderBtn.addEventListener("click", () => {
                if (xpanded == false) {
                    xpanderBox.style.height = "fit-content"
                    xpanderBtn.innerText = "Show less"
                    xpanderInfo.innerText = ""
                    xpanded = true
                }
                else if (xpanded == true) {
                    xpanderBox.style.height = "0"
                    xpanderBtn.innerText = "Show all"
                    xpanderInfo.innerText = info_text
                    xpanded = false
                }
            })
        {% endif %}

        const ctx = document.getElementById('myChart');
    
        new Chart(ctx, {
            data: {
                datasets: [
                    {   
                        type: 'line',
                        label: 'Average citations',
                        data: [11, 11, 12, 15],
                        borderColor: '#c4c4c4',
                        backgroundColor: '#c4c4c4'
                    },
                    {
                        type: 'bar',
                        label: 'Number of citations',
                        data: [10, 17, 18, 23],
                        borderColor: '#23B08F',
                        backgroundColor: '#23B08F'
                    }
                ],
                labels: {{all_years_list}}
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // initialize global variables.
        var edges;
        var nodes;
        var allNodes;
        var allEdges;
        var nodeColors;
        var originalNodes;
        var network;
        var container;
        var options, data;
        var filter = {
            item : '',
            property : '',
            value : []
        };
        // This method is responsible for drawing the graph, returns the drawn network
        function drawGraph() {
            var container = document.getElementById('mynetwork');
            // parsing and collecting nodes and edges from the python
            nodes = new vis.DataSet([{"color": "#23B08F", "id": "asd34", "label": "Roman", "shape": "square", "size": 10}, {"color": "#c4c4c4", "id": "2", "label": "Daniel", "shape": "dot", "size": 10}, {"color": "#c4c4c4", "id": "3", "label": "Hamid", "shape": "dot", "size": 10}, {"color": "#c4c4c4", "id": "4", "label": "Ivan", "shape": "dot", "size": 10}]);
            edges = new vis.DataSet([{"from": "asd34", "to": "2", "width": 1}, {"from": "asd34", "to": "3", "width": 1}, {"from": "asd34", "to": "4", "width": 1}, {"from": "4", "to": "3", "width": 1}]);

            nodeColors = {};
            allNodes = nodes.get({ returnType: "Object" });
            for (nodeId in allNodes) {
            nodeColors[nodeId] = allNodes[nodeId].color;
            }
            allEdges = edges.get({ returnType: "Object" });
            // adding nodes and edges to the graph
            data = {nodes: nodes, edges: edges};

            var options = {
                "configure": {
                "enabled": false
                },
                "edges": {
                "color": {
                    "inherit": true
                },
                "smooth": {
                    "enabled": true,
                    "type": "dynamic"
                }
                },
                "interaction": {
                "dragNodes": true,
                "hideEdgesOnDrag": false,
                "hideNodesOnDrag": false
                },
                "physics": {
                "enabled": true,
                "stabilization": {
                    "enabled": true,
                    "fit": true,
                    "iterations": 1000,
                    "onlyDynamicEdges": false,
                    "updateInterval": 50
                }
                }
                };
            network = new vis.Network(container, data, options);
            return network;
        }
        drawGraph();
    </script>
</body>
</html>